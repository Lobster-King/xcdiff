# xcdiff

A tool to help diff your .xcodeproj files

## Development

### SwiftLint

We've set up SwiftLint (https://github.com/realm/SwiftLint) to enforce Swift style and conventions.
You can run the following command to check if your code does not violate any of the rules.

```
swiftlint
```

### SwiftFormat

We've set up SwiftFormat (https://github.com/nicklockwood/SwiftFormat) to enforce consistent code formatting.

You can run the following command to format your code.

```
swiftformat .
```

### Command Tests

Each markdown file in `CommandTests` represents a single integration test. Those files follow very specific pattern:

```
    # Command
    ```json
    <JSON REPRESENTATION OF THE COMMAND>
    ```

    # Expected exit code
    <NUMBER>

    # Expected output
    ```
    <CONTENT OF THE OUTPUT>
    ```
```

i.e.

```
    # Command
    ```json
    ["-p1", "{ios_project_1}", "-p2", "{ios_project_2}"]
    ```

    # Expected exit code
    1

    # Expected output
    ```
    ❌ TARGETS > NATIVE targets
    ❌ TARGETS > AGGREGATE targets
    ❌ SOURCES > "Project" target
    ❌ SOURCES > "ProjectTests" target
    ❌ SOURCES > "ProjectUITests" target
    ❌ RESOURCES > "Project" target
    ❌ RESOURCES > "ProjectTests" target
    ❌ RESOURCES > "ProjectUITests" target


    ```
```

Thanks to those tests, there is no need to perform any manual tests. Now, we need to just focus on the review process to make sure the files contain the expected output.

All makrdown files in `CommandTests/Manual` are created manually, `CommandTests/Generated` contains test files that are auto-generated by the script `Scripts/generate_tests_commands_files.py`.
`generate_tests_commands_files.py` helps to generate the most obvious cases, like different permutations of the verbose or format options.

**IMPORTANT:** The script needs be updated and run every time we add a new comparator to re-generate the test cases.
